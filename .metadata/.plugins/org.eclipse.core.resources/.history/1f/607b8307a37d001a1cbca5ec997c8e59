package Configuracao;

import java.io.FileOutputStream;
import java.io.IOException;
import java.net.MalformedURLException;

import com.itextpdf.text.BadElementException;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.pdf.ColumnText;
import com.itextpdf.text.pdf.PdfWriter;

public class ConfigRelatorios {
	
	String logotipo           = "C:/Users/Cleiton Braga/eclipse-workspace/Testes/com.meuproejto.Test/logo/Logo.jpg";
	String evidencia          = "C:/Users/Cleiton Braga/Pictures/Testes/evidencia.jpg";
	float  logoposx		      = 400;
	float  logoposy 	      = 700;
	float  logoscalaX     	  = 400;
	float  logoscalay     	  = 200;
	float  evidenciascalax	  = 400;
	float  evidenciascalay	  = 200;
	
	
	Document pdf      = new Document();
	
	
public void  geraPDF(String nomedocumento ) 
{	
	try 
		{
			//PdfWriter.getInstance(pdf,new FileOutputStream("C:/Users/Cleiton Braga/Documents/Teste/"+nomedocumento+".pdf"));
			PdfWriter.getInstance(pdf,new FileOutputStream("C:/Users/Cleiton Braga/eclipse-workspace/Testes/com.meuproejto.Test/relatorios/"+nomedocumento+".pdf"));
			pdf.open();
			pdf.setPageSize(PageSize.A4);
			
		}catch(DocumentException e)
		{
			e.printStackTrace();
				
		}catch(IOException io) 
		{
			io.printStackTrace();	
		}
	
		
}

public void  encerrarPDF() 
{
	pdf.close();

}

public void  incluirPagina(String cabecalho) 
{
	
	try {
		
			Image steps = Image.getInstance(evidencia);
			pdf.newPage();
			pdf.add(new Paragraph(cabecalho));
			steps.scaleToFit(evidenciascalax,evidenciascalay);
			pdf.add(steps);
			
			gerarLogo();
		
	   } catch (DocumentException e) {e.printStackTrace();
	   } catch (MalformedURLException e) {e.printStackTrace();
	   } catch (IOException e) {e.printStackTrace();}
	
}

public void gerarLogo() 
{
	
	try {
			
			Image imagem = Image.getInstance(logotipo);
			imagem.scaleToFit(logoscalaX,logoscalay);
		    imagem.setAbsolutePosition(logoposx,logoposy);
			pdf.add(imagem);
			
	    } catch (BadElementException e)   {e.printStackTrace();
	    } catch (MalformedURLException e) {e.printStackTrace();
	    } catch (IOException e) 	      {e.printStackTrace();
	    } catch (DocumentException e)     {e.printStackTrace();}
	
}

public void incluirImagem(Image imagem) throws DocumentException 
{
	
	pdf.add(imagem);
	
}

public void criarRodape() 
{
	

	 //ColumnText.showTextAligned(writer.getDirectContent(), Element.ALIGN_CENTER, new Phrase("http://www.xxxx-your_example.com/"), 110, 30, 0);
     //ColumnText.showTextAligned(writer.getDirectContent(), Element.ALIGN_CENTER, new Phrase("page " + pdf.getPageNumber()), 550, 30, 0);
	pdf.newPage();
	pdf.addSubject("Rodapé");

}

}



